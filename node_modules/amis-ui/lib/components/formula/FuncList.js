/**
 * amis-ui v2.9.0
 * Copyright 2018-2023 fex
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var tslib = require('tslib');
var React = require('react');
var amisCore = require('amis-core');
var Collapse = require('../Collapse.js');
var CollapseGroup = require('../CollapseGroup.js');
var SearchBox = require('../SearchBox.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);

function FuncList(props) {
    var _a;
    var title = props.title, className = props.className, cx = props.classnames, bodyClassName = props.bodyClassName, descClassName = props.descClassName;
    var _b = tslib.__read(React__default["default"].useState(props.data), 2), filteredFuncs = _b[0], setFiteredFuncs = _b[1];
    var _c = tslib.__read(React__default["default"].useState(null), 2), activeFunc = _c[0], setActiveFunc = _c[1];
    function onSearch(term) {
        var filtered = props.data
            .map(function (item) {
            return tslib.__assign(tslib.__assign({}, item), { items: term
                    ? item.items.filter(function (item) { return ~item.name.indexOf(term.toUpperCase()); })
                    : item.items });
        })
            .filter(function (item) { return item.items.length; });
        setFiteredFuncs(filtered);
    }
    return (React__default["default"].createElement("div", { className: cx('FormulaEditor-FuncList', className) },
        React__default["default"].createElement("div", { className: cx('FormulaEditor-panel') },
            React__default["default"].createElement("div", { className: cx('FormulaEditor-panel-header') }, title),
            React__default["default"].createElement("div", { className: cx('FormulaEditor-panel-body') },
                React__default["default"].createElement("div", { className: cx('FormulaEditor-FuncList-searchBox') },
                    React__default["default"].createElement(SearchBox["default"], { mini: false, onSearch: onSearch })),
                React__default["default"].createElement("div", { className: cx('FormulaEditor-FuncList-body', bodyClassName) },
                    React__default["default"].createElement(CollapseGroup["default"], { className: cx('FormulaEditor-FuncList-collapseGroup'), defaultActiveKey: (_a = filteredFuncs[0]) === null || _a === void 0 ? void 0 : _a.groupName, expandIcon: amisCore.generateIcon(cx, 'fa fa-chevron-right FormulaEditor-FuncList-expandIcon', 'Icon'), accordion: true }, filteredFuncs.map(function (item) { return (React__default["default"].createElement(Collapse["default"], { className: cx('FormulaEditor-FuncList-collapse'), headingClassName: cx('FormulaEditor-FuncList-groupTitle'), bodyClassName: cx('FormulaEditor-FuncList-groupBody'), propKey: item.groupName, header: item.groupName, key: item.groupName }, item.items.map(function (item) { return (React__default["default"].createElement("div", { className: cx('FormulaEditor-FuncList-item', {
                            'is-active': item.name === (activeFunc === null || activeFunc === void 0 ? void 0 : activeFunc.name)
                        }), onMouseEnter: function () { return setActiveFunc(item); }, onClick: function () { var _a; return (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, item); }, key: item.name }, item.name)); }))); }))))),
        React__default["default"].createElement("div", { className: cx('FormulaEditor-panel') },
            React__default["default"].createElement("div", { className: cx('FormulaEditor-panel-header') }, (activeFunc === null || activeFunc === void 0 ? void 0 : activeFunc.name) || ''),
            React__default["default"].createElement("div", { className: cx('FormulaEditor-panel-body') },
                React__default["default"].createElement("div", { className: cx('FormulaEditor-FuncList-doc', descClassName) }, activeFunc ? (React__default["default"].createElement(React__default["default"].Fragment, null,
                    React__default["default"].createElement("pre", null,
                        React__default["default"].createElement("code", null, activeFunc.example)),
                    React__default["default"].createElement("div", { className: cx('FormulaEditor-FuncList-doc-desc') }, activeFunc.description))) : null)))));
}
var FuncList$1 = amisCore.themeable(FuncList);

exports.FuncList = FuncList;
exports["default"] = FuncList$1;
