/**
 * amis-ui v2.9.0
 * Copyright 2018-2023 fex
 */

import { __read, __assign } from 'tslib';
import React__default from 'react';
import { themeable, generateIcon } from 'amis-core';
import Collapse from '../Collapse.js';
import CollapseGroup from '../CollapseGroup.js';
import SearchBox from '../SearchBox.js';

function FuncList(props) {
    var _a;
    var title = props.title, className = props.className, cx = props.classnames, bodyClassName = props.bodyClassName, descClassName = props.descClassName;
    var _b = __read(React__default.useState(props.data), 2), filteredFuncs = _b[0], setFiteredFuncs = _b[1];
    var _c = __read(React__default.useState(null), 2), activeFunc = _c[0], setActiveFunc = _c[1];
    function onSearch(term) {
        var filtered = props.data
            .map(function (item) {
            return __assign(__assign({}, item), { items: term
                    ? item.items.filter(function (item) { return ~item.name.indexOf(term.toUpperCase()); })
                    : item.items });
        })
            .filter(function (item) { return item.items.length; });
        setFiteredFuncs(filtered);
    }
    return (React__default.createElement("div", { className: cx('FormulaEditor-FuncList', className) },
        React__default.createElement("div", { className: cx('FormulaEditor-panel') },
            React__default.createElement("div", { className: cx('FormulaEditor-panel-header') }, title),
            React__default.createElement("div", { className: cx('FormulaEditor-panel-body') },
                React__default.createElement("div", { className: cx('FormulaEditor-FuncList-searchBox') },
                    React__default.createElement(SearchBox, { mini: false, onSearch: onSearch })),
                React__default.createElement("div", { className: cx('FormulaEditor-FuncList-body', bodyClassName) },
                    React__default.createElement(CollapseGroup, { className: cx('FormulaEditor-FuncList-collapseGroup'), defaultActiveKey: (_a = filteredFuncs[0]) === null || _a === void 0 ? void 0 : _a.groupName, expandIcon: generateIcon(cx, 'fa fa-chevron-right FormulaEditor-FuncList-expandIcon', 'Icon'), accordion: true }, filteredFuncs.map(function (item) { return (React__default.createElement(Collapse, { className: cx('FormulaEditor-FuncList-collapse'), headingClassName: cx('FormulaEditor-FuncList-groupTitle'), bodyClassName: cx('FormulaEditor-FuncList-groupBody'), propKey: item.groupName, header: item.groupName, key: item.groupName }, item.items.map(function (item) { return (React__default.createElement("div", { className: cx('FormulaEditor-FuncList-item', {
                            'is-active': item.name === (activeFunc === null || activeFunc === void 0 ? void 0 : activeFunc.name)
                        }), onMouseEnter: function () { return setActiveFunc(item); }, onClick: function () { var _a; return (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, item); }, key: item.name }, item.name)); }))); }))))),
        React__default.createElement("div", { className: cx('FormulaEditor-panel') },
            React__default.createElement("div", { className: cx('FormulaEditor-panel-header') }, (activeFunc === null || activeFunc === void 0 ? void 0 : activeFunc.name) || ''),
            React__default.createElement("div", { className: cx('FormulaEditor-panel-body') },
                React__default.createElement("div", { className: cx('FormulaEditor-FuncList-doc', descClassName) }, activeFunc ? (React__default.createElement(React__default.Fragment, null,
                    React__default.createElement("pre", null,
                        React__default.createElement("code", null, activeFunc.example)),
                    React__default.createElement("div", { className: cx('FormulaEditor-FuncList-doc-desc') }, activeFunc.description))) : null)))));
}
var FuncList$1 = themeable(FuncList);

export { FuncList, FuncList$1 as default };
