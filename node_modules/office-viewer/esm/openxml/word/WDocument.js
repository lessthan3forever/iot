import { __values } from '../../node_modules/tslib/tslib.es6.js';
import { parseColorAttr } from '../../parse/parseColor.js';
import { Body } from './Body.js';

/**
 * Document 解析及类型定义
 * http://webapp.docx4java.org/OnlineDemo/ecma376/WordML/document.html
 * http://webapp.docx4java.org/OnlineDemo/ecma376/WordML/Main%20Document%20Story.html
 */
var WDocument = /** @class */ (function () {
    function WDocument() {
    }
    WDocument.fromXML = function (word, element) {
        var e_1, _a;
        var doc = new WDocument();
        var body = element.querySelector('body');
        if (body) {
            doc.body = Body.fromXML(word, body);
        }
        var background = element.querySelector('background');
        if (background) {
            var documentBackground = {};
            try {
                for (var _b = __values(background.attributes), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var attr = _c.value;
                    var name_1 = attr.name;
                    switch (name_1) {
                        case 'w:color':
                            documentBackground.color = parseColorAttr(word, background, 'w:color');
                            break;
                        case 'w:themeColor':
                            documentBackground.themeColor = parseColorAttr(word, background, 'w:themeColor');
                            break;
                        case 'w:themeShade':
                            documentBackground.themeShade = parseColorAttr(word, background, 'w:themeShade');
                            break;
                        case 'w:themeTint':
                            documentBackground.themeTint = parseColorAttr(word, background, 'w:themeTint');
                            break;
                        default:
                            break;
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        return doc;
    };
    return WDocument;
}());

export { WDocument };
