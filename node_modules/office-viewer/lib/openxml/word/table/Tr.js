'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var tslib_es6 = require('../../../node_modules/tslib/tslib.es6.js');
var OpenXML = require('../../../OpenXML.js');
var Tc = require('./Tc.js');
var parseTrHeight = require('../../../parse/parseTrHeight.js');
var jcToTextAlign = require('../../../parse/jcToTextAlign.js');
var Table = require('../Table.js');

var Tr = /** @class */ (function () {
    function Tr() {
        this.properties = {};
        this.tcs = [];
    }
    Tr.parseTrPr = function (word, element) {
        var e_1, _a;
        var cssStyle = {};
        var tcStyle = {};
        try {
            for (var _b = tslib_es6.__values(element.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                var tagName = child.tagName;
                switch (tagName) {
                    case 'w:hidden':
                        if (OpenXML.getValBoolean(child)) {
                            cssStyle.display = 'none';
                        }
                        break;
                    case 'w:trHeight':
                        parseTrHeight.parseTrHeight(child, cssStyle);
                        break;
                    case 'w:jc':
                        cssStyle['text-align'] = jcToTextAlign.jcToTextAlign(OpenXML.getVal(child));
                        break;
                    case 'w:cantSplit':
                        // 目前也不支持分页
                        break;
                    case 'w:tblPrEx':
                        // http://webapp.docx4java.org/OnlineDemo/ecma376/WordML/tblPrEx_1.html
                        var tablePr = Table.Table.parseTablePr(word, child);
                        Object.assign(cssStyle, tablePr.cssStyle);
                        break;
                    case 'w:tblCellSpacing':
                        Tc.parseTblCellSpacing(child, tcStyle);
                        break;
                    case 'w:cnfStyle':
                        // 目前是自动计算的，所以不需要这个了
                        break;
                    default:
                        console.warn("Tr: Unknown tag ", tagName, child);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return {
            cssStyle: cssStyle
        };
    };
    Tr.fromXML = function (word, element, rowSpanMap) {
        var e_2, _a;
        var tr = new Tr();
        // 做成对象是为了传递引用来修改
        var currentCol = {
            index: 0
        };
        try {
            for (var _b = tslib_es6.__values(element.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                var tagName = child.tagName;
                switch (tagName) {
                    case 'w:tc':
                        var tc = Tc.Tc.fromXML(word, child, currentCol, rowSpanMap);
                        if (tc) {
                            tr.tcs.push(tc);
                        }
                        break;
                    case 'w:trPr':
                        tr.properties = Tr.parseTrPr(word, child);
                        break;
                    case 'w:tblPrEx':
                        // http://webapp.docx4java.org/OnlineDemo/ecma376/WordML/tblPrEx_1.html
                        var tablePr = Table.Table.parseTablePr(word, child);
                        Object.assign(tr.properties.cssStyle || {}, tablePr.cssStyle);
                        break;
                    default:
                        console.warn("Tr: Unknown tag ", tagName, child);
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return tr;
    };
    return Tr;
}());

exports.Tr = Tr;
